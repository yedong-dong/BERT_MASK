# 文档处理系统

## 概述

该代码实现了一个文档处理系统，旨在读取文档内容、进行文本清洗、利用 BERT 模型进行句子填空预测，并将结果输出到文件中。该系统的工作流程可以分为几个主要部分。

## 功能

1. **读取文档**：支持读取多种格式的文档（如 `.docx` 和 `.pdf`）。
2. **文本清洗**：对读取的文本进行清洗，去除换行符、空格和特殊字符。
3. **BERT 模型预测**：使用 BERT 模型预测文本中的错误，并给出可能的填空词。
4. **结果输出**：将预测结果输出到文本文件或标红到 Word 文档中。
5. **白名单功能**：支持加载和更新白名单，进行模糊匹配检查。

## 项目特点

＊　结合了白名单判断，一定程度上减少特殊词汇，姓名等的错误判断。
针对1000份广州市政府公文进行分词并存储在白名单中。在判断时，使用掩码字结合白名单进行相似度的判别，若相似度超过80%，则跳过判断，视为正确的字。

＊  可以输出到文本文件或标红到 Word 文档中。（需要手动在代码调整）

## 代码结构

### 1. 导入必要的库

该代码使用了多个库来实现功能，包括文件操作、正则表达式处理、文本处理和机器学习模型加载等。


### 2. `DocumentProcessor` 类

- **初始化**：该类用于处理文档，`__init__` 方法初始化文件路径。
- **处理文档**：`process_document` 方法读取文档的每一页内容并返回内容列表。如果读取过程中出现错误，捕获异常并打印错误信息。

### 3. 加载 BERT 模型

通过 `load_model` 函数加载预训练的 BERT 分词器（这里指的是03_trained_bert）供后续文本预测使用。

### 4. 读取文档内容

`readContent` 函数根据用户输入的文件类型和路径读取文档内容，并返回处理后的文本。

### 5. 预测函数

`predict` 函数对提供的文本进行清洗和处理，利用 BERT 模型预测文本中的错误，返回结果和可能的填空词。

#### 文本清洗

文本中的换行符、空格和特殊字符会被去除，并进行句子分割。

#### 使用 BERT 进行预测

逐句遍历文本，将每个句子中的特定词汇替换为掩码，输入到 BERT 模型中进行预测。模型返回可能的填空词及其概率。

### 6. 输出结果
输出结果格式为：段落-第几句-字索引-掩码字：【预测结果】：【预测概率】

将预测结果写入output中。

### 7. 白名单功能

从文件中加载白名单词汇，以确保在进行模糊匹配检查时参考已知的正确词汇。

### 8. 主程序入口

设置白名单和读取的文件路径，调用处理函数开始处理。

## 模型总结

该代码结合了文档处理、文本清洗和机器学习模型的使用，能够有效地识别和预测文档中的错误。通过使用 BERT 模型提供了强大的自然语言处理能力，并支持输出和记录处理结果。整体结构清晰，功能模块化，便于后续的扩展和维护。


## 个人总结

该模型的功能尚有提升空间，特别是在处理姓名、特殊词汇等方面的预测效果并不显著。其中，预测敏感率(错误的字)约98.3%,预测准确率(即每一个编码掩码)正确率约89.7%。但特异率约为32.3%，敏感率和特异率不能很好的协调，需要使用者最终自行确认是否需要修改错误字。


